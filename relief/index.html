<!DOCTYPE html>
<html>
  <head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Relief</title>
    <link rel="stylesheet" href="http://js.arcgis.com/3.14/esri/css/esri.css">
    <link rel="stylesheet" href="css/main.css"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
    <script src="http://js.arcgis.com/3.14/"></script>
</head>
  </head>

  <body>
    <div id="map"></div>
  </body>

    <!-- Main Application -->
    <script>

        var map;
        var quakes = [];

        require(["esri/map", "esri/geometry/Circle", "esri/symbols/SimpleFillSymbol", "esri/symbols/SimpleMarkerSymbol", "esri/symbols/SimpleLineSymbol","esri/graphic", "esri/geometry/Point", "esri/Color", "dojo/domReady!"
        ], function (Map, Circle, SimpleFillSymbol, SimpleMarkerSymbol, SimpleLineSymbol, Graphic, Point, Color) {
            
            // parse keys
            Parse.initialize("ahKpQvGXaUQHQ1iCyNGyccBU1hz6UsYIWu1HQcwg", "g15tPzTig1ocoqTPFAiuZvTtYb5iq8QlgOURaZkl");

            // add basemap
            map = new Map("map", {
                basemap: "streets",
                center: [-77.036744, 38.897731],
                zoom: 12
            });

            // on map load
            map.on("load", function () {

                // grab all quakes
                var Quakes = Parse.Object.extend("Quakes");
                var query = new Parse.Query(Quakes);
                query.descending("createdAt");
                query.limit(1000);
                query.find({
                  success: function(objects) {
                        
                   // loop thru all quakes
                   $.each(objects, function(index, quake) {
                        var symbolPoint = new SimpleMarkerSymbol(SimpleMarkerSymbol.STYLE_CIRCLE, map.width/100*quake.get('magnitude'),
                                          new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID, new Color([0, 0, 255]), 1),
                                          new Color([0, 0, 255, 0.25]));
                        var point = new Point([quake.get('center')._longitude, quake.get('center')._latitude]);
                        var pointGraphic = new Graphic(point, symbolPoint);
                        map.graphics.add(pointGraphic);
                   });

                  },
                  error: function(error) {
                    console.log("Error: " + error.code + " " + error.message);
                  }
                });

                

            });

        });

    </script>

</html> 